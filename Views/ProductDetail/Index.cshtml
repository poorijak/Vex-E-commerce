@model Vex_E_commerce.Models.Product

@{
    ViewData["Title"] = "รายการสินค้า";
}

<h2>@ViewData["Title"]</h2>              

<div class="mx-56 pt-20">

    @* path แสดงผล  *@
    <div class="flex pb-10">
        <img src="~/Icon/Vector.svg"/>
        <a asp-action="Index" asp-controller="Home" class="p-5">Home</a>
        <img src="~/Icon/right_Icon.svg" class=""/>
        <a asp-action="Index" asp-controller="ProductDetail" class="p-5">Productdetail</a>
    </div>


    <div class="grid md:grid-cols-2 grid-cols-1 gap-4">
    
        @* Product detail *@
        <img src="@Model.PictureUrl" class="object-cover" />

        <div class="pl-20"> 
            <div>
                <p class="pb-4 text-muted-foreground text-xs md:text-sm">@ViewBag.categoryTitle</p>
                
                <div class="flex justify-between">
                    <h1 class="pb-5 text-2xl font-semibold">@Model.Title</h1>
                </div>

                <form method="post" asp-controller="Cart" asp-action="Add" id="addToCartForm">
                    @Html.AntiForgeryToken()
                    <input type="hidden" name="ProductId" value="@Model.Id" />

                    <!-- สี -->
                    <div class="flex gap-2">
                        <input type="radio" id="color-red" name="Color" value="Red" required />
                        <label for="color-red" class="color-dot bg-red-600"></label>

                        <input type="radio" id="color-black" name="Color" value="Black" />
                        <label for="color-black" class="color-dot bg-black"></label>

                        <input type="radio" id="color-white" name="Color" value="White" />
                        <label for="color-white" class="color-dot bg-white border"></label>
                    </div>

                    <!-- ไซซ์ -->
                    <div class="mt-3 flex gap-2">
                        <input type="radio" id="size-s" name="Size" value="S" required />
                        <label for="size-s" class="chip">S</label>

                        <input type="radio" id="size-m" name="Size" value="M" />
                        <label for="size-m" class="chip">M</label>

                        <input type="radio" id="size-l" name="Size" value="L" />
                        <label for="size-l" class="chip">L</label>
                        <!-- ... -->
                    </div>

                    @* <div class="mt-3">
                        <input type="number" name="Qty" value="1" min="1" class="w-20 border px-2 py-1" />
                    </div> *@

                    <button type="submit" class="mt-4 w-full bg-primary text-white py-2">Add To Cart</button>
                </form>

                @* <h1>@Model.BasePrice</h1>

                <div class="pt-8">
                    <h1 class="pb-5">Select color</h1>
                    
                    <div class="flex flex-row gap-4">
                        
                        <button class="bg-gray-200 px-4 py-2 rounded" onclick="loadVariants('S','Red')">Red</button>
                        <button class="bg-gray-200 px-4 py-2 rounded" onclick="loadVariants('M','Black')">Black</button>
                        <button class="bg-gray-200 px-4 py-2 rounded" onclick="loadVariants('L','White')">White</button>
                        
                    </div>
                </div>

                <div class="pt-8">
                    <h1>Select size</h1>
                    <div class="pt-8">
                        <h1>Available Variants</h1>
                        <div id="variantContainer" class="py-3 grid grid-cols-1 gap-2">
                            <!-- เนื้อหา variant จะโหลดมาใส่ตรงนี้ -->
                        </div>
                    </div>
                    
                </div> *@
               

                <div class="pt-3">
                    <h1>Description</h1>
                    <p class="pt-3 text-xs text-muted-foreground">@Model.Description</p>
                </div>

                <div class="pt-10 grid gap-4">
               
                    <div class="flex w-full items-center justify-center gap-4 border-[0.5px] border-primary px-6 py-4 transition-colors duration-200 hover:cursor-pointer bg-primary text-white">
                        <a asp-action="Cartpage" asp-controller="Cartpage" asp-route-id="@Model.Id">Add To Cart</a>
                        </div>
                    <div class="flex w-full items-center justify-center gap-4 border-[0.5px] border-primary px-6 py-4 transition-colors duration-200 hover:cursor-pointer hover:bg-primary hover:text-white">Buy Nowz</div>
                </div>
            </div>
        </div>

</div>
</div>

@section Scripts {
    <script>
        document.getElementById("addToCartForm").addEventListener("submit", async function (e) {
            e.preventDefault();

            const formData = new FormData(this);

            const res = await fetch("/cart/add", {
                method: "POST",
                body: formData
            });

            const json = await res.json();

            if (json.ok) {
                window.location.href = "/cart/view/" + json.cartId;
            }
        });
    </script>
}

@* @section Scripts {
    <script>
        function loadVariants(size ,color) {
            const productId = '@Model.Id';
            fetch(`/ProductDetail/GetVariantsBySize?productId=${productId}&color=${color}&size=${size}`)
                .then(response => {
                    if (!response.ok) throw new E01rror('Network error');
                    return response.text();
                })
                .then(html => {
                    document.getElementById('variantContainer').innerHTML = html;
                })
                .catch(err => console.error("Error loading variants:", err));
        }
    </script>
} *@
   