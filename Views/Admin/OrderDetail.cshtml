@model Vex_E_commerce.Models.OrderDetailVm

@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
    Layout = "~/Views/Shared/_AdminLayout.cshtml";

    var colorList = new[]
 {
        new { color = "Red",  style = "bg-red-600"      },
        new { color = "Black",  style = "bg-neutral-900"  },
        new { color = "White" ,  style = "bg-white border" },
    };


    var statusList = new[] { "Pending", "Paid", "Shipping", "Completed", "Cancelled" };

    string statusBadgeClass = "";
    string statusLabel = Model.Status.ToString().ToUpper(); // แปลงเป็นตัวพิมพ์ใหญ่

    switch (Model.Status)
    {
        case Vex_E_commerce.Models.OrderStatus.pending:
            // สีเหลือง: รอตรวจสอบ
            statusBadgeClass = "bg-yellow-100 text-yellow-700 border-yellow-200";
            break;

        case Vex_E_commerce.Models.OrderStatus.paid:
            // สีฟ้า: จ่ายแล้ว/รอส่ง
            statusBadgeClass = "bg-blue-100 text-blue-700 border-blue-200";
            break;

        case Vex_E_commerce.Models.OrderStatus.shipped:
            // สีม่วง/คราม: อยู่ระหว่างขนส่ง
            statusBadgeClass = "bg-indigo-100 text-indigo-700 border-indigo-200";
            break;

        case Vex_E_commerce.Models.OrderStatus.delivered:
            // สีเขียว: สำเร็จ
            statusBadgeClass = "bg-green-100 text-green-700 border-green-200";
            break;

        case Vex_E_commerce.Models.OrderStatus.cancelled:
            // สีแดง: ยกเลิก
            statusBadgeClass = "bg-red-100 text-red-700 border-red-200";
            break;

        default:
            statusBadgeClass = "bg-gray-100 text-gray-700 border-gray-200";
            break;
    }

}


<div class="mx-3">
   <div class="flex flex-col items-start justify-start gap-3 md:flex-row md:items-center md:justify-between">
        <div class="flex gap-3">
            <a asp-action="Orders" asp-controller="Admin" class="hidden size-11 items-center justify-center rounded-sm border border-border bg-transparent hover:bg-muted-foreground/10 hover:cursor-pointer md:flex">
                <i class="ph ph-arrow-left text-muted-foreground"></i>
            </a>
            <div>
                <p class="text-muted-foreground hidden text-sm font-semibold md:flex">Back to Order Management</p>
                <h1 class="text-lg font-bold">@Model.OrderNumber</h1>
            </div>
        </div>

        <div class="flex flex-col gap-2">
            <div>
                <span class="rounded-full border px-3 py-1 text-xs font-semibold @statusBadgeClass">
                    @statusLabel
                </span>
            </div>
            
            <p>@Model.CreatedAt</p>
        </div>
   </div>

    <div class="mt-4 grid gap-3 md:grid-cols-1 lg:grid-cols-5">
        <div class="col-span-1 lg:col-span-3">
            <div class="rounded-md border border-border bg-white px-5 py-5">
                <h1 class="text-lg font-bold">Order Item</h1>
                <div class="my-4 h-px flex-1 border-b border-border"></div>
              <div class="my-4 flex flex-col gap-3">
                    @foreach (var i in Model.Items)
                    {
                        <section class="my-2 flex w-full items-center gap-3">
                            <img src="@i.PictureUrl" class="size-13 object-cover" />
                            <div class="flex w-full flex-col gap-2">
                                <p class="text-muted-foreground">@i.ProductCategory</p>
                                <div class="flex w-full items-center justify-between">
                                    <p class="text-lg font-semibold">@i.ProductTitle</p>
                                    <div class="flex items-center justify-center gap-3">
                                        <p>x @i.Quantity</p>
                                        <p>@i.UnitPrice</p>
                                    </div>
                                </div>
                                <div class="text-muted-foreground flex gap-3 text-sm">
                                    <p>@i.VariantText</p>
    
                                </div>
                            </div>
                        </section>
                    }
              </div>
            </div>

            <div class="my-2 rounded-md border border-border bg-white px-5 py-5">
             <h1 class="flex gap-3 text-lg font-bold">
                    Order Summary
                    <span class="rounded-full border px-3 py-1 text-xs font-semibold @statusBadgeClass">
                        @statusLabel
                    </span>
            </h1>
                <div class="my-4 h-px flex-1 border-b border-border"></div>
                <div class="flex flex-col gap-3">
                    <div class="text-muted-foreground flex justify-between gap-2">
                        <p >Subtotal</p>
                        <p>@ViewBag.SubTotal ฿</p>
                    </div>
                    <div class="text-muted-foreground flex justify-between gap-2">
                        <p >Shipping Fee</p>
                        <p>@Model.ShippingFee ฿</p>
                    </div>
                    <div class="flex justify-between gap-2 font-medium text-black">
                        <p >Total</p>
                        <p>@ViewBag.Total ฿</p>
                    </div>
                </div>
            </div>

            <div class="my-2 rounded-md border border-border bg-white px-5 py-5">
                <h1 class="text-lg font-bold">Update order status</h1>
                <div class="my-4 h-px flex-1 border-b border-border"></div>
                <div class="flex flex-col gap-3">
                    <form asp-action="UpdateOrderStatus" asp-controller="Admin" method="post" class="flex items-end gap-4">
                        <input type="hidden" name="orderId" value="@Model.OrderId" />

                        <div class="flex flex-col gap-1">
                            <label class="text-muted-foreground text-xs">Order Status</label>

                            <select name="newStatus"
                                    asp-items="ViewBag.OrderStatusList"
                                    class="min-w-[150px] rounded-sm border border-border bg-white px-3 py-2 text-sm uppercase">
                            </select>
                        </div>

                        <button type="submit" class="rounded-sm bg-black px-4 py-2 text-sm text-white transition hover:bg-gray-800">
                            Update
                        </button>
                    </form>
                </div>
            </div>
        </div>

        <div class="col-span-1 gap-3 lg:col-span-2">
            <div class="rounded-md border border-border bg-white px-5 py-5">
                <h1 class="text-lg font-bold">Customer</h1>
                <div class="my-4 h-px flex-1 border-b border-border"></div>
                <div class="flex flex-col gap-3">
                   <div class="flex items-center gap-2">
                        <i class="ph text-muted-foreground ph-user"></i>
                        <p class="font-medium text-primary">@Model.CustomerEmail</p>
                   </div>
                   <div class="flex items-center gap-2">
                        <i class="ph text-muted-foreground ph-bag"></i>
                        <p class="font-medium text-primary">@Model.CustomerName</p>
                   </div>
                </div>
            </div>
            <div class="my-2 rounded-md border border-border bg-white px-5 py-5">
                <h1 class="text-lg font-bold">Contact Information</h1>
                <div class="my-4 h-px flex-1 border-b border-border"></div>
                <div class="flex flex-col gap-3">
                   <div class="flex items-center gap-2">
                        <i class="ph text-muted-foreground ph-envelope-simple"></i>
                        <p class="font-medium text-primary">@Model.CustomerEmail</p>
                   </div>
                    <div class="text-muted-foreground flex items-center gap-2">
                        <i class="ph text-muted-foreground ph-phone"></i>
                        <p class="font-medium text-primary">@Model.Address.Phone</p>
                   </div>
                </div>
            </div>
            <div class="my-2 rounded-md border border-border bg-white px-5 py-5">
                <h1 class="text-lg font-bold">Shipping Address</h1>
                <div class="my-4 h-px flex-1 border-b border-border"></div>
                <div class="flex flex-col gap-3">
                   <div class="flex flex-col gap-2">
                        <div>
                            <label class="text-muted-foreground text-xs">Name</label>
                            <p class="text-sm font-medium text-primary">@Model.Address.Name</p>
                        </div>
                        <div>
                            <label class="text-muted-foreground text-xs">Phone</label>
                            <p class="text-sm font-medium text-primary">@Model.Address.Phone</p>
                        </div>
                        <div>
                            <label class="text-muted-foreground text-xs">Address Details</label>
                            <p class="text-sm font-medium text-primary">@Model.Address.AddressDetail</p>
                        </div>
                        <div>
                            <label class="text-muted-foreground text-xs">Province, District, Sub-district</label>
                            <p class="text-sm font-medium text-primary">@Model.Address.Province</p>
                        </div>
                        <div>
                            <label class="text-muted-foreground text-xs">Postal Code</label>
                            <p class="text-sm font-medium text-primary">@Model.Address.PostalCode</p>
                        </div>
                        <div>
                            <label class="text-muted-foreground text-xs">Note</label>
                            <p class="text-sm font-medium text-primary">@Model.Address.Note</p>
                        </div>
                   </div>
                </div>
            </div>
            
        </div>
    </div>
</div>


