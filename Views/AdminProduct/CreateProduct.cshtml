@model Vex_E_commerce.Models.ProductFormVm
@{
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}

<div class="w-full">
    <form asp-action="CreateProduct" method="post">
        @Html.AntiForgeryToken()
            
       <div class="flex items-center justify-between">
                <h1 class="text-2xl font-bold">Add New Product</h1>
                <div >
                    <button type="submit"
                            class="cursor-pointer bg-primary px-7 py-2 text-white hover:bg-primary/90">
                        Save Product
                    </button>
                </div>
       </div>
        <div class="mt-5 h-px border-b border-border"></div>

        <div class="grid grid-cols-1 md:grid-cols-3">
            <div class="col-span-1 mt-3 border-r border-border pr-5">
                <div class="flex flex-col gap-3">
                    <div>
                        @* ส่ง model เข้า partial เพื่อใช้ asp-for ใน partial ได้ *@
                        <partial name="AdminPartial/_ProductImage" model="Model" />

                    </div>

                    <div>
                        <h2 class="my-3 font-semibold">General Information</h2>
                        <div class="flex flex-col gap-4">
                            <div class="flex flex-col gap-2">
                                <label class="font-mono text-sm" asp-for="Title">
                                    Title <span class="text-red-500">*</span>
                                </label>
                                <input asp-for="Title"
                                       placeholder="Enter product title..."
                                       class="h-9 w-full rounded-sm border-[#D9D9D9] border-[0.5px] bg-white pl-4 placeholder:text-sm placeholder:text-[#D9D9D9]" />
                                <span class="text-xs text-red-500" asp-validation-for="Title"></span>
                            </div>

                            <div class="flex flex-col gap-2">
                                <label class="font-mono text-sm text-gray-900" asp-for="Description">
                                    Description
                                </label>
                                <textarea asp-for="Description"
                                          rows="4"
                                          class="block w-full rounded-sm border border-border bg-white p-2.5 text-sm text-gray-900 placeholder:text-[#D9D9D9]"
                                          placeholder="Enter product description"></textarea>
                                <span class="text-xs text-red-500" asp-validation-for="Description"></span>
                            </div>
                        </div>
                    </div>

                    <div class="my-2 h-px flex-1 border-b border-border"></div>

                    <h2 class="font-semibold">Category</h2>
                    <div class="flex flex-col gap-2">
                        <label class="font-mono text-sm text-gray-900" asp-for="CategoryId">
                            Category <span class="text-red-500">*</span>
                        </label>

                        @* ใช้ง่ายสุด: select ที่ bind กับ CategoryId *@
                        <select asp-for="CategoryId"
                                asp-items="@(new SelectList(Model.Categories, nameof(Vex_E_commerce.Models.Category.Id), nameof(Vex_E_commerce.Models.Category.Title)))"
                                class="rounded-sm border border-border bg-white px-4 py-2.5 text-sm">
                            <option value="">-- Select Category --</option>
                        </select>
                        <span class="text-xs text-red-500" asp-validation-for="CategoryId"></span>
                    </div>

                    <div class="my-2 h-px flex-1 border-b border-border"></div>

                    <div class="mb-10">
                        <h2 class="mb-3 font-medium">Pricing</h2>
                        <div class="flex flex-col gap-2">
                            <label class="font-mono text-sm" asp-for="BasePrice">
                                Base Price
                            </label>
                            <input asp-for="BasePrice" type="number" step="0.01"
                                   placeholder="0.00"
                                   class="h-9 w-full rounded-sm border-[#D9D9D9] border-[0.5px] bg-white pl-4 placeholder:text-sm placeholder:text-[#D9D9D9]" />
                            <span class="text-xs text-red-500" asp-validation-for="BasePrice"></span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-span-2 mt-3 pl-5">
                <partial name="AdminPartial/_Product_variant" />
                <input asp-for="VariantJson" type="hidden" id="VariantJson" />
            </div>
        </div>

       
    </form>
</div>



<script>
    const button = document.getElementById("dropdownDefaultButton");
    const menu = document.getElementById("dropdown");
    const categoryIdInput = document.getElementById("selectedCategoryId");
    const categoryTitleSpan = document.getElementById("selectedCategorySpan");
    const categoryItems = document.querySelectorAll(".category-item");

    button.addEventListener("click", (event) => {
        event.preventDefault();
        menu.classList.toggle("hidden");
    });

    categoryItems.forEach((item) => {
        item.addEventListener("click", (event) => {
            event.preventDefault();
            const id = item.getAttribute("data-id");
            const title = item.getAttribute("data-title");
            categoryIdInput.value = id;
            categoryTitleSpan.textContent = title;
            menu.classList.add("hidden");
        });
    });

    document.addEventListener("click", function (event) {
        if (!button.contains(event.target) && !menu.contains(event.target)) {
            if (!menu.classList.contains("hidden")) {
                menu.classList.add("hidden");
            }
        }
    });
</script>
